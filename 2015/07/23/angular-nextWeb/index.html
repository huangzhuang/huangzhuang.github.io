<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>angular.js开发下一代web读书笔记 | hzhuang的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="article">
<meta property="og:title" content="angular.js开发下一代web读书笔记">
<meta property="og:url" content="http://huangzhuang.github.io/2015/07/23/angular-nextWeb/index.html">
<meta property="og:site_name" content="hzhuang的博客">
<meta property="og:description">
<meta property="og:image" content="http://hz2015.sinaapp.com/static/pictures/angular.jpg">
<meta property="og:image" content="http://hz2015.sinaapp.com/static/pictures/MVC.png">
<meta property="og:image" content="http://hz2015.sinaapp.com/static/pictures/angular-workflow.png">
<meta property="og:updated_time" content="2015-07-27T03:32:54.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="angular.js开发下一代web读书笔记">
<meta name="twitter:description">
  
    <link rel="alternative" href="/atom.xml" title="hzhuang的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://hz2015.sinaapp.com/static/images/zhuang.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">hzhuang</a></h1>
		</hgroup>

		
		<p class="header-subtitle">人若无名，便可专心练剑！</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
							<li><a href="/tags/css3">css3</a></li>
				        
							<li><a href="/tags/js">javascript</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/huangzhuang" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/1875236755/profile?topnav=1&wvr=6" title="weibo">weibo</a>
					        
								<a class="zhihu" target="_blank" href="http://www.zhihu.com/people/huang-zhuang-225" title="zhihu">zhihu</a>
					        
								<a class="rss" target="_blank" href="/#" title="rss">rss</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/MVC/" style="font-size: 10px;">MVC</a> <a href="/tags/animation/" style="font-size: 10px;">animation</a> <a href="/tags/autosize/" style="font-size: 10px;">autosize</a> <a href="/tags/codewars/" style="font-size: 10px;">codewars</a> <a href="/tags/css/" style="font-size: 10px;">css</a> <a href="/tags/css3/" style="font-size: 16px;">css3</a> <a href="/tags/iscroll/" style="font-size: 10px;">iscroll</a> <a href="/tags/js/" style="font-size: 20px;">js</a> <a href="/tags/learning/" style="font-size: 14px;">learning</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a> <a href="/tags/reqexp/" style="font-size: 10px;">reqexp</a> <a href="/tags/transition/" style="font-size: 10px;">transition</a> <a href="/tags/代码规范/" style="font-size: 12px;">代码规范</a> <a href="/tags/前端/" style="font-size: 18px;">前端</a> <a href="/tags/前端框架/" style="font-size: 10px;">前端框架</a> <a href="/tags/学习笔记/" style="font-size: 10px;">学习笔记</a> <a href="/tags/模仿qq/" style="font-size: 10px;">模仿qq</a> <a href="/tags/笔记/" style="font-size: 10px;">笔记</a> <a href="/tags/简书/" style="font-size: 10px;">简书</a> <a href="/tags/设计模式/" style="font-size: 10px;">设计模式</a> <a href="/tags/选择器/" style="font-size: 10px;">选择器</a> <a href="/tags/高级程序/" style="font-size: 10px;">高级程序</a>
					</div>
				</section>
				
				
				

				
				
				<section class="switch-part switch-part3">
				
					<div id="js-aboutme">华中科技大学13级硕士，在读。想从事前端类工作，努力奋进中。。。</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">hzhuang</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="http://hz2015.sinaapp.com/static/images/zhuang.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">hzhuang</h1>
			</hgroup>
			
			<p class="header-subtitle">人若无名，便可专心练剑！</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
					<li><a href="/tags/css3">css3</a></li>
		        
					<li><a href="/tags/js">javascript</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/huangzhuang" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/1875236755/profile?topnav=1&wvr=6" title="weibo">weibo</a>
			        
						<a class="zhihu" target="_blank" href="http://www.zhihu.com/people/huang-zhuang-225" title="zhihu">zhihu</a>
			        
						<a class="rss" target="_blank" href="/#" title="rss">rss</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-angular-nextWeb" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/07/23/angular-nextWeb/" class="article-date">
  	<time datetime="2015-07-23T01:30:30.000Z" itemprop="datePublished">2015-07-23</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      angular.js开发下一代web读书笔记
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC/">MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/">js</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/前端框架/">前端框架</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/学习笔记/">学习笔记</a></li></ul>
	</div>

        

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="http://hz2015.sinaapp.com/static/pictures/angular.jpg" alt=""><br><a id="more"></a></p>
<p>##谈到angular.js可以想到什么？</p>
<ul>
<li>核心特性:MVC，模块化，自动化双向数据绑定，语义化标签，依赖注入(首次应用于前端框架。)。</li>
<li>TDD(测试驱动)。</li>
<li>解决html实现动态页面的困难。</li>
</ul>
<p>#angular框架中的基本概念</p>
<p>##1.客户端模板<br>区别于基于ajax的单页面是在服务器端装配模板和data，然后把生成的页面发送到浏览器。而angular.js是服务器把数据和模板都发到浏览器，然后再客户端中进行装配。<br><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">div</span> <span class="attribute">ng-controller</span>=<span class="value">"HelloController"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">p</span>&gt;</span></span><span class="expression">&#123;&#123;<span class="variable">greeting.text</span>&#125;&#125;</span><span class="xml">, world<span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 应用逻辑 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="actionscript"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">HelloController</span><span class="params">($scope)</span></span>&#123;</span><br><span class="line">		$scope.greeting = &#123;text: <span class="string">"Hello"</span>&#125;;</span><br><span class="line">	&#125;</span><br><span class="line"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p>
<p>$scope对象是模板的<strong>域模型</strong>，也称为作用域实例，为其赋值，可以传到模板中渲染。<br>$scope对象可以精确的控制域模型的那些数据和操作在视图上是有效的。</p>
<p>其中，使用的是google的CDN。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"https://ajax.googleapis.com/ajax/libs/angularjs/1.2.0/angular.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>##2.MVC<br>model:管理数据的代码; angular.js中就是存储数据的对象。<br>controller：应用逻辑代码; angular.js中就是js类。<br>view：展示数据的代码; angular.js中DOM。</p>
<p><img src="http://hz2015.sinaapp.com/static/pictures/MVC.png" alt="MVC逻辑图"></p>
<p>##3.数据绑定<br>最新的数据插入到UI中，或者用户的输入修改数据。不必要使用代码来实现。使用<strong>映射</strong>让它们自动同步: UI中的某个部分映射某个js的属性。<br><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input <span class="class"><span class="keyword">type</span></span>=<span class="string">"text"</span> ng-model=<span class="string">"greeting.text"</span>&gt;;</span><br></pre></td></tr></table></figure></p>
<p>##4.依赖注入<br>只需要简单的获取它们所需要的东西，而不需要创建那些它们所依赖的东西。比如$scope。</p>
<p>##5.指令<br>把模板编写成HTML的形式。因为angular引入了一款强大的DOM转换引擎，可以扩展HTML的语法。</p>
<p>ng-app: 告诉angular页面中的哪些部分需要接受它的管理。<br>ng-xxxController: 控制器。<br>ng-repeat:<br>ng-click: 点击触发的事件。</p>
<p>#AngularJs应用骨架</p>
<p>##调用Angular</p>
<ul>
<li>加载angular.js库。</li>
<li>ng-app指令指定angular管理的DOM部分。</li>
</ul>
<p>###加载脚本<br>CDN:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"https://ajax.googleapis.com/ajax/libs/angularjs/1.2.0/angular.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>google服务器快，而且可以在多个应用之间缓存脚本库。</p>
<p>###使用ng-app声明Angular的边界<br>如果要打造一款纯angular应用，则可以把ng-app指令放在html标签内。</p>
<p>#Model View Controller</p>
<ul>
<li>容纳数据的模型</li>
<li>展示数据的视图</li>
<li>管理模块和视图之间关系的控制器</li>
</ul>
<p>双括号插值语法</p>
<p>控制器就是编写的类，告诉angular这个模型是由哪些对象或者基本数据构成的。<br>如果数据少的话可以直接用基本数据存储，但是大部分的时候是创建模型对象来容纳数据。<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">	<span class="keyword">function</span> TextController(<span class="variable">$scope</span>)&#123;</span><br><span class="line">		var messages = &#123;&#125;;</span><br><span class="line">		messages.sometext = <span class="string">"huangzhuang.github.io"</span>;</span><br><span class="line">		<span class="variable">$scope</span>.messages = messages;</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p>事实上，控制器的编写不应该实在全局命名空间的，所以正确的做法就是应该把它定义成模块的一部分，然后使用命名空间机制。如下：<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;html ng-app = <span class="string">"hzhuang-app"</span>&gt;</span><br><span class="line">...</span><br><span class="line">&lt;script&gt;</span><br><span class="line">	var appModuel = angular.module(<span class="string">"hzhuang-app"</span>,[]);</span><br><span class="line">	//angular对象创建名为hzhuang-app的模块。后面的空数组表示不依赖其他模块。</span><br><span class="line">	appModuel.controller(<span class="string">"TextController"</span>, <span class="keyword">function</span>(<span class="variable">$scope</span>)&#123; </span><br><span class="line">	//控制器函数传递给appModuel的consroller函数</span><br><span class="line">		var messages = &#123;&#125;;</span><br><span class="line">		messages.sometext = <span class="string">"huangzhuang.github.io"</span>;</span><br><span class="line">		<span class="variable">$scope</span>.messages = messages;</span><br><span class="line">	&#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="模板和数据绑定">模板和数据绑定</h2><p>工作流程：<br><img src="http://hz2015.sinaapp.com/static/pictures/angular-workflow.png" alt=""></p>
<p>###显示文本<br>ng-bind指令<br>虽然双括号插值法也可以，但是这种方法会导致没有渲染好模块会直接显示给用户一段时间的问题。</p>
<p>###表单输入<br>ng-model属性把元素绑定到模型属性上。<br>ng-change属性指定一个控制器方法，一旦用户修改了输入值，这个方法就会被调用。<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;form ng-controller=<span class="string">"StartUpController"</span>&gt;</span><br><span class="line">	Starting: &lt;input type=<span class="string">"text"</span> ng-change = <span class="string">"computeNeeded()"</span> ng-model=<span class="string">"funding.startingEstimate"</span>&gt;</span><br><span class="line">	Recommendation: &#123;&#123;funding.needed&#125;&#125;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">	<span class="keyword">function</span> StartUpController(<span class="variable">$scope</span>)&#123;</span><br><span class="line">		<span class="variable">$scope</span>.funding = &#123;startingEstimate: <span class="number">0</span>&#125;;</span><br><span class="line">		<span class="variable">$scope</span>.computeNeeded = function()&#123;</span><br><span class="line">			<span class="variable">$scope</span>.funding.needed = <span class="variable">$scope</span>.funding.startingEstimate * <span class="number">10</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p>以上的实例会有一个问题：如果还有其他的输入框也绑定到模型的这个属性上，如果接受到服务器端的数据，就会导致模型刷新。<br>so，$scope对象的$watch()函数来解决这个问题。它来监视一个表达式，当这个表达式发生变化的时候就会调用一个回调函数。<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">	<span class="keyword">function</span> StartUpController(<span class="variable">$scope</span>)&#123;</span><br><span class="line">		<span class="variable">$scope</span>.funding = &#123;startingEstimate: <span class="number">0</span>&#125;;</span><br><span class="line">		computeNeeded = function()&#123;</span><br><span class="line">			<span class="variable">$scope</span>.funding.needed = <span class="variable">$scope</span>.funding.startingEstimate * <span class="number">10</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="variable">$scope</span>.<span class="variable">$watch</span>(<span class="string">"funding.startingEstimate"</span>, computeNeeded);</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p>ng-submit在提交表格的时候执行。<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="tag">form</span> ng-controller=<span class="string">"StartUpController"</span> ng-submit=<span class="string">"requestFunding()"</span>&gt;</span><br></pre></td></tr></table></figure></p>
<p>在提交表单的时候，ng-submit会自动组织浏览器执行默认的POST操作。<br>ng-click<br>ng-dbclick</p>
<p>###浅谈非入侵式javascript</p>
<ul>
<li>并不是所有的浏览器都支持js。</li>
<li>有人会使用非常奇怪的浏览器，屏幕阅读器。</li>
<li>在不同的方式运行的效果不同。</li>
<li>事件处理都在全局，不同库相同函数名会冲突。</li>
<li>时间监听会绑定数据结构和行为，难以维护、扩展和理解。</li>
</ul>
<p>对于angular而言，以上的第三点和第四点，对于内联的时间监听有等价的形式ng-eventhandler = “xxx”。<br>优点：</p>
<ul>
<li>屏蔽不同浏览器的差异性。</li>
<li>不会在全局命名空间中操作。</li>
</ul>
<p>对于第五点，angular处理的时候根本就没有引用DOM，都是在内部完成的。</p>
<h3 id="列表，表格以及其他迭代性元素">列表，表格以及其他迭代性元素</h3><p>主要就是详细讲解<strong>ng-repeat</strong></p>
<p>$index返回当前引用的元素序号,类似的是$middle还有$last</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul ng-controller=<span class="string">"StudentListController"</span>&gt;</span><br><span class="line">	&lt;li ng-repeat = <span class="string">"student in students"</span>&gt;</span><br><span class="line">		&lt;a href=<span class="string">"#"</span>&gt;&#123;&#123;student.name&#125;&#125; + &#123;&#123;<span class="variable">$index</span>&#125;&#125;&lt;/a&gt;</span><br><span class="line">	&lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">	var students = [</span><br><span class="line">		&#123;name : <span class="string">"hzhuang"</span> , id : <span class="number">1</span>&#125;,</span><br><span class="line">		&#123;name : <span class="string">"huangkai"</span>, id : <span class="number">2</span>&#125;,</span><br><span class="line">		&#123;name : <span class="string">"fangjie"</span>, id : <span class="number">3</span>&#125;</span><br><span class="line">	];</span><br><span class="line">	<span class="keyword">function</span> StudentListController(<span class="variable">$scope</span>)&#123;</span><br><span class="line">		<span class="variable">$scope</span>.students = students;</span><br><span class="line">		<span class="variable">$scope</span>.students.splice(<span class="number">1</span>,<span class="number">0</span>,&#123;name : <span class="string">"xuxiaofeng"</span>, id : <span class="number">4</span>&#125;);</span><br><span class="line">	&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h3 id="隐藏和显示">隐藏和显示</h3><p><strong>ng-show和ng-hide</strong></p>
<h3 id="css类与样式">css类与样式</h3><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.menu-disabled-<span class="keyword">true</span>&#123;</span><br><span class="line">	color:gray;</span><br><span class="line">&#125;</span><br><span class="line">&lt;li <span class="keyword">class</span> = <span class="string">"menu-disabled-&#123;&#123;isDisabled&#125;&#125;"</span>&gt;&lt;/li&gt;</span><br></pre></td></tr></table></figure>
<p>以上的方法可以实现，但是同时在模板和js中使用的话就会无法维护。<br>在angular中，<strong>ng-class</strong>和<strong>ng-style</strong>指令。<br><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">ng-controller</span>=<span class="value">"HeaderConrtoller"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">div</span> <span class="attribute">ng-class</span>=<span class="value">"&#123;error:isError, warning:isWarening&#125;"</span>&gt;</span></span><span class="expression">&#123;&#123;<span class="variable">messageText</span>&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">button</span> <span class="attribute">ng-click</span> = "<span class="attribute">showError</span>()"&gt;</span>Error<span class="tag">&lt;/<span class="title">button</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">button</span> <span class="attribute">ng-click</span> = "<span class="attribute">showWarning</span>()"&gt;</span>Warning<span class="tag">&lt;/<span class="title">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="actionscript"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">HeaderController</span><span class="params">($scope)</span></span>&#123;</span><br><span class="line">		xxx;</span><br><span class="line">	&#125;</span><br><span class="line"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p>
<p>###反思src和href属性<br><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="title">img</span> <span class="attribute">ng-src</span>=<span class="value">"http://hz2015.sinaapp.com/static/pictures/</span></span></span><span class="expression">&#123;&#123;<span class="variable">name</span>&#125;&#125;</span><span class="xml"><span class="tag"><span class="value">"</span> <span class="attribute">alt</span>=<span class="value">""</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">a</span> <span class="attribute">ng-href</span>=<span class="value">"http://hz2015.sinaapp.com"</span>&gt;</span><span class="tag">&lt;/<span class="title">a</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p>
<p>###表达式<br>表示是可以充分的灵活性在模板、业务逻辑和数据之间建立联系，同时又可以避免业务逻辑渗透到模板中。</p>
<p>###区分UI和控制器的职责<br>控制器的职责</p>
<ul>
<li>为模板设置初始状态</li>
<li>通过$Scope对象把数据模型和函数暴露给视图。</li>
<li>监视模板其余部分的变化，并采取相应的动作。</li>
</ul>
<p>###利用$scope暴露模型数据<br>显性创建很常见了，下来来看简介的创建$scope属性的方法：</p>
<ul>
<li><p>表达式法：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">button</span> <span class="attribute">ng-click</span>=<span class="value">"count=5"</span>&gt;</span>press<span class="tag">&lt;/<span class="title">button</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>表单输入项中使用ng-model。在表单项和指定的模板数据之间建立双向绑定关系。</p>
</li>
</ul>
<p>###使用$watch监控数据模型的变化<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$watch</span>(watchFn, watchAction, deepWatch);</span><br></pre></td></tr></table></figure></p>
<p>watchFn:是一个带有angular表达式或者函数的<strong>字符串</strong>。<br>watchAction:函数或者表达式，当watchFn变化的时候被调用。函数签名是<br><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span><span class="params">(newValue, oldValue, scope)</span></span>;</span><br></pre></td></tr></table></figure></p>
<p>deepWatch: 检查被监控的对象的<strong>每个属性</strong>是否发生了变化。</p>
<p>$watch函数会返回一个函数。可以使用这个返回值注销这个函数。</p>
<p>带折扣的购物车以及注意watch()中的性能注意事项见P30-P34。</p>
<p>###监控多个东西</p>
<ul>
<li><p>监控把这些属性链接起来之后的值</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$scope</span>.<span class="variable">$watch</span>(<span class="string">"things.a + things.b"</span>, doSomething);</span><br></pre></td></tr></table></figure>
</li>
<li><p>把他们放进一个数组或者对象中，然后给deepWatch参数设置成true</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$scope</span>.<span class="variable">$watch</span>(<span class="string">"things"</span>, doSomething, <span class="literal">true</span>);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="使用Module组织依赖关系">使用Module组织依赖关系</h2><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">	<span class="keyword">function</span> ShoppingController(<span class="variable">$scope</span>, Items)&#123;</span><br><span class="line">		<span class="variable">$scope</span>.items = Items.query();</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>以上假设Items这个对象已经被定义成一个服务。<br>服务都是单例的对象。<br>angular.js内置很多服务：</p>
<ul>
<li>$location用来和浏览器的地址栏交互。</li>
<li>$route用来根据URL地址的变化切换视图。</li>
<li>$http用来和服务器交互。</li>
<li>自定义服务，可以在不同的控制器之间共享。</li>
</ul>
<p>模型对象的API来定义服务。</p>
<table>
<thead>
<tr>
<th style="text-align:left">函数</th>
<th style="text-align:left">定义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">provider(name, Object OR constructor())</td>
<td style="text-align:left">返回服务的名称，如果是Object，则Object必须有一个$get的函数。如果是constructor(),则会返回服务实例对象。</td>
</tr>
<tr>
<td style="text-align:left">factory(name, $getFunction())</td>
<td style="text-align:left">返回服务实例。看成以上Object时候的情形。</td>
</tr>
<tr>
<td style="text-align:left">server(name, constructor())</td>
<td style="text-align:left">比较简单，看成最上面是constructor的情形</td>
</tr>
</tbody>
</table>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">	<span class="keyword">function</span> ShoppingController(<span class="variable">$scope</span>, Items)&#123;</span><br><span class="line">		<span class="variable">$scope</span>.items = Items.query();</span><br><span class="line">	&#125;</span><br><span class="line">	//创建一个模型来支持视图</span><br><span class="line">	var shoppingModule = angular.module(<span class="string">"shoppingModule"</span>, []);</span><br><span class="line">	shoppingModule.factory(<span class="string">"Items"</span>, <span class="keyword">function</span>()&#123;</span><br><span class="line">		var items =&#123;&#125;;</span><br><span class="line">		items.query = function()&#123;</span><br><span class="line">          return [</span><br><span class="line">            &#123;title: <span class="string">'Paint pots'</span>, description: <span class="string">'Pots full of paint'</span>, price: <span class="number">3.95</span>&#125;,</span><br><span class="line">            &#123;title: <span class="string">'Polka dots'</span>, description: <span class="string">'Dots with polka'</span>, price: <span class="number">2.95</span>&#125;,</span><br><span class="line">            &#123;title: <span class="string">'Pebbles'</span>, description: <span class="string">'Just little rocks'</span>, price: <span class="number">6.95</span>&#125;</span><br><span class="line">          ];</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h3 id="使用过滤器格式化数据">使用过滤器格式化数据</h3><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="expansion">&#123;&#123;expression | filterName <span class="symbol">:</span> parameter1 <span class="symbol">:</span> ... parameterN&#125;&#125;</span>\</span><br><span class="line"><span class="expansion">&#123;&#123;<span class="number">12.9</span> | currency&#125;&#125;</span></span><br></pre></td></tr></table></figure>
<p>angular内置的过滤器还有：date, number, uppercase<br>同时也可以自定义过滤器。<br><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="title">body</span> <span class="attribute">ng-app</span>=<span class="value">"HomeModule"</span> <span class="attribute">ng-controller</span>=<span class="value">"HomeController"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">h1</span>&gt;</span></span><span class="expression">&#123;&#123;<span class="variable">pageHeading</span> | <span class="variable">titleCase</span>&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="title">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="actionscript"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">HomeController</span><span class="params">($scope)</span></span>&#123;</span><br><span class="line">		$scope.pageHeading = <span class="string">"hzhuang is a very nice man!"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">var</span> homeModule = angular.module(<span class="string">"HomeModule"</span>, []);</span><br><span class="line">	homeModule.filter(<span class="string">"titleCase"</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">var</span> titleCaseFilter = <span class="function"><span class="keyword">function</span><span class="params">(input)</span></span>&#123;</span><br><span class="line">			<span class="keyword">var</span> words = input.split(<span class="string">" "</span>);</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ,len = words.length; i&lt; len; i++ )&#123;</span><br><span class="line">				words[i] = words[i].charAt(<span class="number">0</span>).toUpperCase() + words[i].slice(<span class="number">1</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="keyword">return</span> words.join(<span class="string">" "</span>);</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">return</span> titleCaseFilter;</span><br><span class="line">	&#125;);</span><br><span class="line"></span><br><span class="line"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p>
<p>###使用路由和$location切换视图<br>利用路由服务来定义：对于浏览器所指向的特定URL，angular将会加载并显示一个模板，并实例化一个控制器来为模板提供内容。<br>调用$routeProvider服务上的函数来创建路由，把需要创建的路由当成一个配置快传给这些函数。</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var someModule = angular.module(<span class="string">"someModule"</span>, []);</span><br><span class="line">someModule.config(<span class="keyword">function</span>(<span class="variable">$routeProvider</span>)&#123;</span><br><span class="line">	<span class="variable">$routeProvider</span>.</span><br><span class="line">	when(<span class="string">"url"</span>, &#123;controller:aController, templateURL:<span class="string">"/path/to/template"</span>&#125;).</span><br><span class="line">	when(...other mappings for you app).</span><br><span class="line">	...</span><br><span class="line">	otherwise(...what to do if no match);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>以创建邮件为例子。<br>在第一个加载的页面中仅仅创建一个布局模板，然后用这个模板来容纳各种视图。ng-view指令。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">//index.html</span><br><span class="line"><span class="doctype">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">html</span> <span class="attribute">ng-app</span>=<span class="value">"AMail"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"http://ajax.googleapis.com/ajax/libs/angularjs/1.0.8/angular.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">'controllers.js'</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">h1</span>&gt;</span>A-Mail<span class="tag">&lt;/<span class="title">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">ng-view</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>用ng-repeat来遍历邮件列表，然后渲染到table中。<br><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">//list.html</span><br><span class="line"><span class="tag">&lt;<span class="title">table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">td</span>&gt;</span><span class="tag">&lt;<span class="title">strong</span>&gt;</span>Sender<span class="tag">&lt;/<span class="title">strong</span>&gt;</span><span class="tag">&lt;/<span class="title">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">td</span>&gt;</span><span class="tag">&lt;<span class="title">strong</span>&gt;</span>Subject<span class="tag">&lt;/<span class="title">strong</span>&gt;</span><span class="tag">&lt;/<span class="title">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">td</span>&gt;</span><span class="tag">&lt;<span class="title">strong</span>&gt;</span>Date<span class="tag">&lt;/<span class="title">strong</span>&gt;</span><span class="tag">&lt;/<span class="title">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">tr</span> <span class="attribute">ng-repeat</span>=<span class="value">'message in messages'</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">td</span>&gt;</span></span><span class="expression">&#123;&#123;<span class="variable">message.sender</span>&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="title">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">td</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">ng-href</span>=<span class="value">'#/view/</span></span></span><span class="expression">&#123;&#123;<span class="variable">message.id</span>&#125;&#125;</span><span class="xml"><span class="tag"><span class="value">'</span>&gt;</span></span><span class="expression">&#123;&#123;<span class="variable">message.subject</span>&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">td</span>&gt;</span></span><span class="expression">&#123;&#123;<span class="variable">message.date</span>&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="title">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">table</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p>
<p>想达到用户点击主题就会跳转到相应的邮件中，我们可以在URL和message.id中数据绑定。点击id=1的邮件就会被导航到/#/view/1。<br>创建一个模板，用来展示单个邮件对象上的属性。<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;&lt;strong&gt;<span class="constant">Subject</span><span class="symbol">:&lt;/strong&gt;</span> <span class="expansion">&#123;&#123;message.subject&#125;&#125;</span>&lt;<span class="regexp">/div&gt;</span><br><span class="line">&lt;div&gt;&lt;strong&gt;Sender:&lt;/strong</span>&gt; <span class="expansion">&#123;&#123;message.sender&#125;&#125;</span>&lt;<span class="regexp">/div&gt;</span><br><span class="line">&lt;div&gt;&lt;strong&gt;Date:&lt;/strong</span>&gt; <span class="expansion">&#123;&#123;message.date&#125;&#125;</span>&lt;<span class="regexp">/div&gt;</span><br><span class="line">&lt;div&gt;</span><br><span class="line">  &lt;strong&gt;To:&lt;/strong</span>&gt;</span><br><span class="line">  &lt;span ng-repeat=<span class="string">'recipient in message.recipients'</span>&gt;<span class="expansion">&#123;&#123;recipient&#125;&#125;</span> &lt;<span class="regexp">/span&gt;</span><br><span class="line">&lt;/div</span>&gt;</span><br><span class="line">&lt;div&gt;<span class="expansion">&#123;&#123;message.message&#125;&#125;</span>&lt;<span class="regexp">/div&gt;</span><br><span class="line">&lt;a href='#/</span><span class="string">'&gt;Back to message list&lt;/a&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>就下来就可以配置URL<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">	var aMailServices = angular.module(<span class="string">"AMail"</span>, []);</span><br><span class="line">	<span class="keyword">function</span> emailRouteConfig(<span class="variable">$routeProvider</span>)&#123;</span><br><span class="line">		<span class="variable">$routeProvider</span>.</span><br><span class="line">		when(<span class="string">"/"</span>, &#123;controller: ListController, templateUrl: <span class="string">"list.html"</span>&#125;).</span><br><span class="line">		when(<span class="string">"/view/:id"</span>,&#123;controller: DetailController, templateUrl: <span class="string">"detail.html"</span>&#125;).</span><br><span class="line">		otherwise(&#123;redirectTo: <span class="string">"/"</span>&#125;);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	aMailServices.config(emailRouteConfig);</span><br><span class="line">	<span class="keyword">function</span> ListController(<span class="variable">$scope</span>) &#123;</span><br><span class="line">	  <span class="variable">$scope</span>.messages = messages;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">function</span> DetailController(<span class="variable">$scope</span>, <span class="variable">$routeParams</span>) &#123;</span><br><span class="line">	  <span class="variable">$scope</span>.message = messages[<span class="variable">$routeParams</span>.id];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p>可见，可以实现修改url的值实现切换视图。且实际上只有一个唯一真实的html页面。</p>
<p>###与服务器交互（$http）<br>$http提供一个可扩展的抽象方法列表，使得与服务器交互更加简单。支持http、Jsonp和cors方式。包含安全性支持。</p>
<p>如果查询“/products”时可以返回一个json数据。<br>则：<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> shoppingController(<span class="variable">$scope</span>, <span class="variable">$http</span>)&#123;</span><br><span class="line">	<span class="variable">$http</span>.get(<span class="string">"/products"</span>).success(function(data, status, headers, config)&#123;</span><br><span class="line">		<span class="variable">$scope</span>.items = data;</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>然后后ng-repeat指令就可以把这些json数据的信息渲染到视图中。</p>
<h3 id="使用指令修改DOM">使用指令修改DOM</h3><p>angular内置没有这个功能的指令，所以可以自定义指令。<br>通过模块对象的API来定义指令<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable"><span class="keyword">var</span> appModule</span> = angular.module(<span class="string">"appModule"</span>, []);</span><br><span class="line">appModule.directive(<span class="string">"directiveName"</span>, directiveFunction);</span><br><span class="line"><span class="comment">//调用directive()即可。</span></span><br><span class="line"><span class="comment">//directiveFunction是一个工厂函数，用来定义指令的特性。</span></span><br></pre></td></tr></table></figure></p>
<p>实例：<br><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> appModule = angular.module(<span class="string">"appModule"</span>, []);</span><br><span class="line">appModule.directive(<span class="string">"ngFocus"</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">	link: <span class="function"><span class="keyword">function</span><span class="params">(scope, element, attrs, controller)</span></span>&#123;</span><br><span class="line">	element[<span class="number">0</span>].focus();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>###校验用户输入<br>angular中，必须所有的元素都是合法的情况下才会允许提交。<br>思路是这样的，在html5中使用required，以及输入的；类型比如number，email等，如果浏览器不支持h5的这些属性，angular会自动通过指令来实现。</p>
<p>在控制器中，可以使用$valid来获取表单的校验状态。所有合法时是true。<br>涉及到ng-disabled指令和$valid属性。<br><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">h1</span>&gt;</span>Sign Up<span class="tag">&lt;/<span class="title">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">form</span> <span class="attribute">name</span>=<span class="value">'addUserForm'</span> <span class="attribute">ng-controller</span>=<span class="value">"AddUserController"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">ng-show</span>=<span class="value">'message'</span>&gt;</span></span><span class="expression">&#123;&#123;<span class="variable">message</span>&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">div</span>&gt;</span>First name: <span class="tag">&lt;<span class="title">input</span> <span class="attribute">name</span>=<span class="value">'firstName'</span> <span class="attribute">ng-model</span>=<span class="value">'user.first'</span> <span class="attribute">required</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">div</span>&gt;</span>Last name: <span class="tag">&lt;<span class="title">input</span> <span class="attribute">ng-model</span>=<span class="value">'user.last'</span> <span class="attribute">required</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">div</span>&gt;</span>Email: <span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">'email'</span> <span class="attribute">ng-model</span>=<span class="value">'user.email'</span> <span class="attribute">required</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">div</span>&gt;</span>Age: <span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">'number'</span></span><br><span class="line">                     <span class="attribute">ng-model</span>=<span class="value">'user.age'</span></span><br><span class="line">                     <span class="attribute">ng-maxlength</span>=<span class="value">'3'</span></span><br><span class="line">                     <span class="attribute">ng-min</span>=<span class="value">'1'</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">div</span>&gt;</span><span class="tag">&lt;<span class="title">button</span> <span class="attribute">ng-click</span>=<span class="value">'addUser()'</span></span><br><span class="line">                 <span class="attribute">ng-disabled</span>=<span class="value">'!addUserForm.$valid'</span>&gt;</span>Submit<span class="tag">&lt;/<span class="title">button</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="actionscript"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">AddUserController</span><span class="params">($scope)</span> </span>&#123;</span><br><span class="line">    $scope.message = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line">    $scope.addUser = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="comment">// TODO for the reader: actually save user to database...</span></span><br><span class="line">      $scope.message = <span class="string">'Thanks, '</span> + $scope.user.first + <span class="string">', we added you!'</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p>
<p>几点说明：</p>
<ul>
<li>ng-disabled=’!addUserForm.$valid’来实现党所有的输入项合法就会恢复可点击。</li>
<li>.ng-invalid {border-color: red;}输入项还不是合法的时候的样式。（内置的）</li>
</ul>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2015/09/20/codewars/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          每日一战(codewars)
        
      </div>
    </a>
  
  
    <a href="/2015/06/29/designPattern/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">javascript设计模式</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>


<div class="share">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">分享到：</span>
		<a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
		<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1405949716054953" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>



<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="angular-nextWeb" data-title="angular.js开发下一代web读书笔记" data-url="http://huangzhuang.github.io/2015/07/23/angular-nextWeb/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"true"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>




</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2015 hzhuang
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>